<!doctype html>
<html lang="de">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Satire-Balancer – Minimal</title>
<style>
  :root{
    --bg:#ffffff;
    --fg:#111111;
    --muted:#6b7280;
    --line:#e5e7eb;
    --ok:#16a34a;
    --warn:#f59e0b;
    --bad:#f97316;
    --red:#ef4444;
    --barH:14px;
    --barW:14px;
    --radius:10px;
  }
  *{box-sizing:border-box}
  html,body{height:100%;background:var(--bg);color:var(--fg);font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif}
  .app{height:100%;display:grid;grid-template-rows:auto 1fr auto;gap:12px;padding:12px;max-width:900px;margin:0 auto}

  .header,.footer{display:flex;align-items:center;justify-content:space-between;gap:12px}
  .title{font-weight:800}
  .subtitle{color:var(--muted);font-size:.95rem}
  .btn{background:#fff;border:1px solid var(--line);border-radius:8px;padding:8px 12px;cursor:pointer}
  .btn:hover{border-color:#d1d5db}

  .board{
    display:grid;
    grid-template-rows: var(--barH) 1fr var(--barH);
    grid-template-columns: var(--barW) 1fr var(--barW);
    gap:8px;
    height:calc(100vh - 140px);
    min-height:420px;
  }

  /* Skalen */
  .scale-h{
    grid-column: 1 / 4;
    height:var(--barH);
    background:#fff;border:1px solid var(--line);border-radius:999px;display:flex;align-items:center;padding:0 8px;gap:8px
  }
  .scale-h .name{min-width:92px;font-size:.85rem;color:var(--muted)}
  .meter{position:relative;flex:1;height:8px;background:#f3f4f6;border-radius:999px;overflow:hidden}
  .bar{position:absolute;left:0;top:0;bottom:0;width:50%;background:var(--ok);transition:width .2s ease, background-color .2s ease}
  .value{min-width:60px;text-align:right;font-variant-numeric:tabular-nums;color:var(--muted);font-size:.85rem}

  .scale-v{
    width:var(--barW);
    background:#fff;border:1px solid var(--line);border-radius:999px;display:flex;flex-direction:column;align-items:center;padding:6px 0;gap:6px
  }
  .scale-v .name{writing-mode:vertical-rl;transform:rotate(180deg);font-size:.75rem;color:var(--muted)}
  .meter-v{position:relative;width:8px;flex:1;background:#f3f4f6;border-radius:999px;overflow:hidden}
  .bar-v{position:absolute;left:0;bottom:0;width:100%;height:50%;background:var(--ok);transition:height .2s ease, background-color .2s ease}
  .value-v{font-variant-numeric:tabular-nums;color:var(--muted);font-size:.75rem}

  #topScale{grid-row:1;grid-column:1/4}
  #bottomScale{grid-row:3;grid-column:1/4}
  #leftScale{grid-row:1/4;grid-column:1}
  #rightScale{grid-row:1/4;grid-column:3}

  .playfield{
    grid-row:2;grid-column:2;
    position:relative;background:#fff;border:1px dashed var(--line);border-radius:16px;overflow:hidden;
  }
  .hint{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);color:var(--muted);font-size:.9rem;pointer-events:none}

  /* Chips */
  .chip{
    position:absolute;display:flex;align-items:center;justify-content:center;
    width:64px;height:64px;border-radius:16px;border:1px solid var(--line);background:#fff;
    font-size:32px;cursor:pointer;box-shadow:0 2px 10px rgba(0,0,0,.04);
    transition:transform .08s ease, box-shadow .2s ease, opacity 1s linear;
    opacity:1;
  }
  .chip:active{transform:translateY(1px) scale(.98)}
  .chip:hover{box-shadow:0 6px 18px rgba(0,0,0,.06)}
  .chip.clicked{opacity:.3}
  .chip.aging{opacity:0;}

  /* Overlay */
  .overlay{position:fixed;inset:0;background:rgba(0,0,0,.35);display:none;place-items:center;padding:16px}
  .modal{background:#fff;border:1px solid var(--line);border-radius:14px;padding:16px;max-width:520px;width:100%;text-align:center}
  .why{margin-top:8px;text-align:left;border:1px solid var(--line);border-radius:10px;padding:10px;background:#fafafa}
  .why .row{display:flex;gap:8px;align-items:center}
  .dot{width:8px;height:8px;border-radius:50%;background:var(--red);display:inline-block}
</style>
</head>
<body>
<div class="app">
  <div class="header">
    <div>
      <div class="title">Satire-Balancer (weiß & minimal)</div>
      <div class="subtitle">Klick auf zufällig auftauchende Emojis. <strong>Nie zwei Skalen gleichzeitig im Rot-Bereich.</strong></div>
    </div>
    <div style="display:flex;gap:8px;align-items:center">
      <div id="turns" class="subtitle">Züge: 0</div>
      <button class="btn" id="resetBtn">Neustart</button>
    </div>
  </div>

  <div class="board">
    <div id="topScale" class="scale-h">
      <div class="name">🙂 Laune</div>
      <div class="meter"><div id="bar-laune" class="bar"></div></div>
      <div id="val-laune" class="value">—</div>
    </div>

    <div id="leftScale" class="scale-v">
      <div class="name">Gesundheit</div>
      <div class="meter-v"><div id="bar-gesundheit" class="bar-v"></div></div>
      <div id="val-gesundheit" class="value-v">—</div>
    </div>

    <div id="playfield" class="playfield">
      <div class="hint">Tippe die auftauchenden Emojis</div>
    </div>

    <div id="rightScale" class="scale-v">
      <div class="name">Stress</div>
      <div class="meter-v"><div id="bar-stress" class="bar-v"></div></div>
      <div id="val-stress" class="value-v">—</div>
    </div>

    <div id="bottomScale" class="scale-h">
      <div class="name">⚡ Energie</div>
      <div class="meter"><div id="bar-energie" class="bar"></div></div>
      <div id="val-energie" class="value">—</div>
    </div>
  </div>

  <div class="footer">
    <div class="subtitle">Rot-Bereiche: Laune/Gesundheit/Energie &lt;20 • Stress &gt;80</div>
    <div class="subtitle">Alle 2 s: Decay (Laune−2, Gesundheit−1, Energie−2, Stress+2)</div>
  </div>
</div>

<div class="overlay" id="overlay">
  <div class="modal">
    <h2>🚨 Doppel-Rot!</h2>
    <p>Zwei Skalen im kritischen Bereich. Versuch’s nochmal!</p>
    <div class="why" id="whyList"></div>
    <div style="margin-top:10px"><button class="btn" id="againBtn">Nochmal</button></div>
  </div>
</div>

<script>
const THRESHOLDS = { lowRed:20, stressRed:80 };
const START = { laune:55, gesundheit:60, stress:45, energie:50 };
const DECAY = { laune:-2, gesundheit:-1, energie:-2, stress:+2 };
const DECAY_INTERVAL_MS = 2000;

const ACTIONS = [
  { emoji:'🍺', effects:{ laune:+12, gesundheit:-10, energie:-8 } },
  { emoji:'🚬', effects:{ laune:+8, gesundheit:-9, stress:-8 } },
  { emoji:'☕', effects:{ stress:-6, energie:+12 } },
  { emoji:'💧', effects:{ laune:-3, gesundheit:+10 } },
  { emoji:'🥗', effects:{ laune:-4, gesundheit:+11, energie:+6 } },
  { emoji:'🍔', effects:{ laune:+9, gesundheit:-10, energie:+8 } },
  { emoji:'🍫', effects:{ laune:+8, gesundheit:-6, energie:+6 } },
  { emoji:'⚡', effects:{ gesundheit:-8, energie:+14 } },
];

let state = { values:{...START}, turns:0 };
let spawnTimer=null, decayTimer=null;

const pf=document.getElementById('playfield');
const bars={
  laune:document.getElementById('bar-laune'),
  gesundheit:document.getElementById('bar-gesundheit'),
  stress:document.getElementById('bar-stress'),
  energie:document.getElementById('bar-energie')
};
const vals={
  laune:document.getElementById('val-laune'),
  gesundheit:document.getElementById('val-gesundheit'),
  stress:document.getElementById('val-stress'),
  energie:document.getElementById('val-energie')
};
const turnsEl=document.getElementById('turns');
const overlayEl=document.getElementById('overlay');
const whyList=document.getElementById('whyList');

document.getElementById('resetBtn').addEventListener('click',reset);
document.getElementById('againBtn').addEventListener('click',reset);

const clamp=v=>Math.max(0,Math.min(100,v));
function colorFor(key,v){
  if(key==='stress'){ if(v>80) return 'var(--red)'; if(v>65) return 'var(--bad)'; if(v>40) return 'var(--warn)'; return 'var(--ok)'; }
  else { if(v<20) return 'var(--red)'; if(v<35) return 'var(--bad)'; if(v<60) return 'var(--warn)'; return 'var(--ok)'; }
}
function render(){
  bars.laune.style.width=state.values.laune+'%';
  bars.energie.style.width=state.values.energie+'%';
  bars.gesundheit.style.height=state.values.gesundheit+'%';
  bars.stress.style.height=state.values.stress+'%';
  bars.laune.style.background=colorFor('laune',state.values.laune);
  bars.energie.style.background=colorFor('energie',state.values.energie);
  bars.gesundheit.style.background=colorFor('gesundheit',state.values.gesundheit);
  bars.stress.style.background=colorFor('stress',state.values.stress);
  vals.laune.textContent=Math.round(state.values.laune)+'%';
  vals.energie.textContent=Math.round(state.values.energie)+'%';
  vals.gesundheit.textContent=Math.round(state.values.gesundheit)+'%';
  vals.stress.textContent=Math.round(state.values.stress)+'%';
  turnsEl.textContent='Züge: '+state.turns;
}
function apply(eff){
  state.turns++;
  for(const[k,d] of Object.entries(eff)){ state.values[k]=clamp(state.values[k]+d); }
  render(); check();
}
function check(){
  const reds=[];
  if(state.values.laune<20) reds.push('🙂 Laune <20');
  if(state.values.gesundheit<20) reds.push('❤️ Gesundheit <20');
  if(state.values.energie<20) reds.push('⚡ Energie <20');
  if(state.values.stress>80) reds.push('🔥 Stress >80');
  if(reds.length>=2){ whyList.innerHTML=reds.map(r=>`<div class="row"><span class="dot"></span>${r}</div>`).join(''); overlayEl.style.display='grid'; stop(); }
}
function decay(){ for(const[k,d] of Object.entries(DECAY)){ state.values[k]=clamp(state.values[k]+d);} render(); check(); }

function spawnOnce(){
  const count=Math.random()<0.45?1:2;
  const picks=new Array(count).fill(0).map(_=>ACTIONS[Math.floor(Math.random()*ACTIONS.length)]);
  const rect=pf.getBoundingClientRect();
  const size=Math.min(64,Math.max(56,Math.floor(Math.min(rect.width,rect.height)*0.12)));
  picks.forEach((act,i)=>{
    const el=document.createElement('div');
    el.className='chip'; el.textContent=act.emoji;
    el.style.width=size+'px'; el.style.height=size+'px';
    el.style.left=Math.round(Math.random()*(rect.width-size))+'px';
    el.style.top=Math.round(Math.random()*(rect.height-size))+'px';
    el.addEventListener('click',()=>{ if(el.classList.contains('clicked'))return; el.classList.add('clicked'); apply(act.effects); });
    pf.appendChild(el);
    setTimeout(()=>{ if(document.body.contains(el)) el.classList.add('aging'); },4000);
    setTimeout(()=>{ if(document.body.contains(el)) el.remove(); },5000);
  });
}
function start(){ spawnOnce(); spawnTimer=setInterval(spawnOnce,rand(700,1100)); decayTimer=setInterval(decay,2000); }
function stop(){ clearInterval(spawnTimer); clearInterval(decayTimer); }
function rand(a,b){return Math.floor(Math.random()*(b-a+1))+a;}
function reset(){ overlayEl.style.display='none'; state={values:{...START},turns:0}; render(); pf.innerHTML='<div class="hint">Tippe die auftauchenden Emojis</div>'; start(); }

render(); start();
</script>
</body>
</html>
